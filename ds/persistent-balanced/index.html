<!doctype html><html lang="zh" class="no-js"><head> <meta charset="utf-8"> <meta http-equiv="x-dns-prefetch-control" content="on"> <link rel="dns-prefetch" href="//oi-wiki.org"> <link rel="dns-prefetch" href="//search.oi-wiki.org"> <link rel="dns-prefetch" href="//cdn.jsdelivr.net"> <link rel="dns-prefetch" href="//api.github.com"> <link rel="dns-prefetch" href="//cdn-for-oi-wiki.billchn.com"> <link rel="dns-prefetch" href="//www.google-analytics.com"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta http-equiv="x-ua-compatible" content="ie=edge"> <meta name="description" content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛"> <link rel="canonical" href="https://oi-wiki.org/ds/persistent-balanced/"> <meta name="author" content="OI Wiki Team"> <meta name="lang:clipboard.copy" content="复制"> <meta name="lang:clipboard.copied" content="已复制"> <meta name="lang:search.language" content="jp"> <meta name="lang:search.pipeline.stopwords" content="True"> <meta name="lang:search.pipeline.trimmer" content="True"> <meta name="lang:search.result.none" content="没有找到符合条件的结果"> <meta name="lang:search.result.one" content="找到 1 个符合条件的结果"> <meta name="lang:search.result.other" content="# 个符合条件的结果"> <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+"> <link rel="shortcut icon" href="https://cdn.jsdelivr.net/npm/oicdn@0.0.1/favicon.ico"> <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.4.2"> <title>可持久化平衡树 - OI Wiki</title> <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css"> <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css"> <meta name="theme-color" content=""> <script src="../../assets/javascripts/modernizr.27508f0e.js"></script> <style>@font-face{font-family:'Fira Sans';font-style:normal;font-weight:300;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:italic;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot);src:local('Fira Sans'),local('FiraSans-Italic'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:700;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot);src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans) format('svg')}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot);src:local('Fira Mono'),local('FiraMono-Normal'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono) format('svg')}body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/material-icons@0.2.3/iconfont/material-icons.min.css"> <link rel="manifest" href="../../manifest.webmanifest"> <link rel="stylesheet" href="../../_static/css/extra.css?v=13"> <script> window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-124485594-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  }) </script> <script async="" src="https://www.google-analytics.com/analytics.js"></script> <style>.mjpage .MJX-monospace{font-family:monospace}.mjpage .MJX-sans-serif{font-family:sans-serif}.mjpage{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.mjpage *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.mjx-svg-href{fill:#00f;stroke:#00f}.MathJax_SVG_LineBox{display:table!important}.MathJax_SVG_LineBox span{display:table-cell!important;width:10000em!important;min-width:0;max-width:none;padding:0;border:0;margin:0}.mjpage__block{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}</style></head> <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red"> <svg class="md-svg"> <defs> <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"></path></svg> </defs> </svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label> <a href="#treap" tabindex="1" class="md-skip"> 跳转至 </a> <header class="md-header" data-md-component="header"> <nav class="md-header-nav md-grid"> <div class="md-flex"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="https://oi-wiki.org" title="OI Wiki" class="md-header-nav__button md-logo"> <i class="md-icon">school</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"> <span class="md-header-nav__topic"> OI Wiki </span> <span class="md-header-nav__topic"> 可持久化平衡树 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">  </button> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="result"> <div class="md-search-result__meta"> 键入以开始搜索 </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class="md-header-nav__source"> <a href="https://github.com/OI-wiki/OI-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github"> <div class="md-source__icon"> <svg viewBox="0 0 24 24" width="24" height="24"> <use xlink:href="#__github" width="24" height="24"></use> </svg> </div> <div class="md-source__repository"> OI-wiki/OI-wiki </div> </a> </div> </div> </div> </nav> </header> <div class="md-container"> <nav class="md-tabs md-tabs--active" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../.." class="md-tabs__link"> 简介 </a> </li> <li class="md-tabs__item"> <a href="../../lang/" class="md-tabs__link"> 语言基础 </a> </li> <li class="md-tabs__item"> <a href="../../basic/" class="md-tabs__link"> 算法基础 </a> </li> <li class="md-tabs__item"> <a href="../../search/" class="md-tabs__link"> 搜索 </a> </li> <li class="md-tabs__item"> <a href="../../dp/" class="md-tabs__link"> 动态规划 </a> </li> <li class="md-tabs__item"> <a href="../../string/" class="md-tabs__link"> 字符串 </a> </li> <li class="md-tabs__item"> <a href="../../math/" class="md-tabs__link"> 数学 </a> </li> <li class="md-tabs__item"> <a href="../" class="md-tabs__link md-tabs__link--active"> 数据结构 </a> </li> <li class="md-tabs__item"> <a href="../../graph/" class="md-tabs__link"> 图论 </a> </li> <li class="md-tabs__item"> <a href="../../geometry/" class="md-tabs__link"> 计算几何 </a> </li> <li class="md-tabs__item"> <a href="../../misc/" class="md-tabs__link"> 杂项 </a> </li> <li class="md-tabs__item"> <a href="../../topic/rmq/" class="md-tabs__link"> 专题 </a> </li> <li class="md-tabs__item"> <a href="../../intro/hulu/" class="md-tabs__link"> 关于 Hulu </a> </li> </ul> </div> </nav> <main class="md-main" role="main"> <div class="md-main__inner md-grid" data-md-component="container"> <div class="md-sidebar md-sidebar--primary" data-md-component="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title md-nav__title--site" for="__drawer"> <a href="https://oi-wiki.org" title="OI Wiki" class="md-nav__button md-logo"> <i class="md-icon">school</i> </a> OI Wiki </label> <div class="md-nav__source"> <a href="https://github.com/OI-wiki/OI-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github"> <div class="md-source__icon"> <svg viewBox="0 0 24 24" width="24" height="24"> <use xlink:href="#__github" width="24" height="24"></use> </svg> </div> <div class="md-source__repository"> OI-wiki/OI-wiki </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"> <label class="md-nav__link" for="nav-1"> 简介 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-1"> 简介 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../.." title="Getting Started" class="md-nav__link"> Getting Started </a> </li> <li class="md-nav__item"> <a href="../../intro/oi/" title="OI 赛事与赛制" class="md-nav__link"> OI 赛事与赛制 </a> </li> <li class="md-nav__item"> <a href="../../intro/icpc/" title="ICPC/CCPC 赛事与赛制" class="md-nav__link"> ICPC/CCPC 赛事与赛制 </a> </li> <li class="md-nav__item"> <a href="../../intro/roadmap/" title="学习路线" class="md-nav__link"> 学习路线 </a> </li> <li class="md-nav__item"> <a href="../../intro/resources/" title="学习资源" class="md-nav__link"> 学习资源 </a> </li> <li class="md-nav__item"> <a href="../../intro/common-mistakes/" title="常见错误" class="md-nav__link"> 常见错误 </a> </li> <li class="md-nav__item"> <a href="../../intro/common-tricks/" title="常见技巧" class="md-nav__link"> 常见技巧 </a> </li> <li class="md-nav__item"> <a href="../../intro/non-trad/" title="非传统题" class="md-nav__link"> 非传统题 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-9" type="checkbox" id="nav-1-9"> <label class="md-nav__link" for="nav-1-9"> 工具软件 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-1-9"> 工具软件 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../intro/judgers/" title="评测工具" class="md-nav__link"> 评测工具 </a> </li> <li class="md-nav__item"> <a href="../../intro/wsl/" title="WSL (Windows 10)" class="md-nav__link"> WSL (Windows 10) </a> </li> <li class="md-nav__item"> <a href="../../intro/spj/" title="Special Judge" class="md-nav__link"> Special Judge </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-9-4" type="checkbox" id="nav-1-9-4"> <label class="md-nav__link" for="nav-1-9-4"> Testlib </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-1-9-4"> Testlib </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../intro/testlib/" title="Testlib 简介" class="md-nav__link"> Testlib 简介 </a> </li> <li class="md-nav__item"> <a href="../../intro/testlib/general/" title="通用" class="md-nav__link"> 通用 </a> </li> <li class="md-nav__item"> <a href="../../intro/testlib/generator/" title="Generator" class="md-nav__link"> Generator </a> </li> <li class="md-nav__item"> <a href="../../intro/testlib/validator/" title="Validator" class="md-nav__link"> Validator </a> </li> <li class="md-nav__item"> <a href="../../intro/testlib/interactor/" title="Interactor" class="md-nav__link"> Interactor </a> </li> <li class="md-nav__item"> <a href="../../intro/testlib/checker/" title="Checker" class="md-nav__link"> Checker </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../intro/polygon/" title="Polygon" class="md-nav__link"> Polygon </a> </li> <li class="md-nav__item"> <a href="../../intro/oj-tool/" title="OJ 工具" class="md-nav__link"> OJ 工具 </a> </li> <li class="md-nav__item"> <a href="../../intro/latex/" title="LaTeX 入门" class="md-nav__link"> LaTeX 入门 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../intro/docker-deploy/" title="Docker 部署" class="md-nav__link"> Docker 部署 </a> </li> <li class="md-nav__item"> <a href="../../intro/about/" title="关于本项目" class="md-nav__link"> 关于本项目 </a> </li> <li class="md-nav__item"> <a href="../../intro/htc/" title="如何参与" class="md-nav__link"> 如何参与 </a> </li> <li class="md-nav__item"> <a href="../../intro/faq/" title="F.A.Q." class="md-nav__link"> F.A.Q. </a> </li> <li class="md-nav__item"> <a href="../../intro/thanks/" title="致谢" class="md-nav__link"> 致谢 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"> <label class="md-nav__link" for="nav-2"> 语言基础 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-2"> 语言基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/" title="语言基础简介" class="md-nav__link"> 语言基础简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2"> <label class="md-nav__link" for="nav-2-2"> 编辑工具 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-2-2"> 编辑工具 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/editor/vim/" title="Vim" class="md-nav__link"> Vim </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/emacs/" title="Emacs" class="md-nav__link"> Emacs </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/vscode/" title="VS Code" class="md-nav__link"> VS Code </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/atom/" title="Atom" class="md-nav__link"> Atom </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/eclipse/" title="Eclipse" class="md-nav__link"> Eclipse </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/npp/" title="Notepad++" class="md-nav__link"> Notepad++ </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/devcpp/" title="Dev-C++" class="md-nav__link"> Dev-C++ </a> </li> <li class="md-nav__item"> <a href="../../lang/editor/geany/" title="Geany" class="md-nav__link"> Geany </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3"> <label class="md-nav__link" for="nav-2-3"> C++ 基础 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-2-3"> C++ 基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/helloworld/" title="Hello, World!" class="md-nav__link"> Hello, World! </a> </li> <li class="md-nav__item"> <a href="../../lang/basic/" title="C++ 语法基础" class="md-nav__link"> C++ 语法基础 </a> </li> <li class="md-nav__item"> <a href="../../lang/var/" title="变量" class="md-nav__link"> 变量 </a> </li> <li class="md-nav__item"> <a href="../../lang/op/" title="运算" class="md-nav__link"> 运算 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-5" type="checkbox" id="nav-2-3-5"> <label class="md-nav__link" for="nav-2-3-5"> 流程控制语句 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-2-3-5"> 流程控制语句 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/branch/" title="分支" class="md-nav__link"> 分支 </a> </li> <li class="md-nav__item"> <a href="../../lang/loop/" title="循环" class="md-nav__link"> 循环 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-6" type="checkbox" id="nav-2-3-6"> <label class="md-nav__link" for="nav-2-3-6"> 高级数据类型 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-2-3-6"> 高级数据类型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/array/" title="数组" class="md-nav__link"> 数组 </a> </li> <li class="md-nav__item"> <a href="../../lang/struct/" title="结构体" class="md-nav__link"> 结构体 </a> </li> <li class="md-nav__item"> <a href="../../lang/pointer/" title="指针" class="md-nav__link"> 指针 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/func/" title="函数" class="md-nav__link"> 函数 </a> </li> <li class="md-nav__item"> <a href="../../lang/file-op/" title="文件操作" class="md-nav__link"> 文件操作 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4"> <label class="md-nav__link" for="nav-2-4"> C++ 标准库 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-2-4"> C++ 标准库 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/csl/" title="C++ 标准库简介" class="md-nav__link"> C++ 标准库简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-2" type="checkbox" id="nav-2-4-2"> <label class="md-nav__link" for="nav-2-4-2"> STL 容器 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-2-4-2"> STL 容器 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/csl/container/" title="STL 容器简介" class="md-nav__link"> STL 容器简介 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/iterator/" title="迭代器" class="md-nav__link"> 迭代器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/sequence-container/" title="序列式容器" class="md-nav__link"> 序列式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/associative-container/" title="关联式容器" class="md-nav__link"> 关联式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/unordered-container/" title="无序关联式容器" class="md-nav__link"> 无序关联式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/container-adapter/" title="容器适配器" class="md-nav__link"> 容器适配器 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/csl/algorithm/" title="STL 算法" class="md-nav__link"> STL 算法 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/bitset/" title="bitset" class="md-nav__link"> bitset </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/string/" title="string" class="md-nav__link"> string </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5"> <label class="md-nav__link" for="nav-2-5"> C++ 进阶 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-2-5"> C++ 进阶 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/class/" title="类" class="md-nav__link"> 类 </a> </li> <li class="md-nav__item"> <a href="../../lang/namespace/" title="命名空间" class="md-nav__link"> 命名空间 </a> </li> <li class="md-nav__item"> <a href="../../lang/reference/" title="引用" class="md-nav__link"> 引用 </a> </li> <li class="md-nav__item"> <a href="../../lang/const/" title="常值" class="md-nav__link"> 常值 </a> </li> <li class="md-nav__item"> <a href="../../lang/new/" title="新版 C++ 特性" class="md-nav__link"> 新版 C++ 特性 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-6" type="checkbox" id="nav-2-5-6"> <label class="md-nav__link" for="nav-2-5-6"> pb_ds </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-2-5-6"> pb_ds </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/pb-ds/" title="pb_ds 简介" class="md-nav__link"> pb_ds 简介 </a> </li> <li class="md-nav__item"> <a href="../../lang/pb-ds/pq/" title="堆" class="md-nav__link"> 堆 </a> </li> <li class="md-nav__item"> <a href="../../lang/pb-ds/tree/" title="平衡树" class="md-nav__link"> 平衡树 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/c-cpp/" title="C 与 C++ 区别" class="md-nav__link"> C 与 C++ 区别 </a> </li> <li class="md-nav__item"> <a href="../../lang/pas-cpp/" title="Pascal 转 C++ 急救" class="md-nav__link"> Pascal 转 C++ 急救 </a> </li> <li class="md-nav__item"> <a href="../../lang/python/" title="Python 速成" class="md-nav__link"> Python 速成 </a> </li> <li class="md-nav__item"> <a href="../../lang/java/" title="Java 速成" class="md-nav__link"> Java 速成 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"> <label class="md-nav__link" for="nav-3"> 算法基础 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-3"> 算法基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../basic/" title="算法基础简介" class="md-nav__link"> 算法基础简介 </a> </li> <li class="md-nav__item"> <a href="../../basic/enumerate/" title="枚举" class="md-nav__link"> 枚举 </a> </li> <li class="md-nav__item"> <a href="../../basic/simulate/" title="模拟" class="md-nav__link"> 模拟 </a> </li> <li class="md-nav__item"> <a href="../../basic/divide-and-conquer/" title="递归 &amp; 分治" class="md-nav__link"> 递归 &amp; 分治 </a> </li> <li class="md-nav__item"> <a href="../../basic/greedy/" title="贪心" class="md-nav__link"> 贪心 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6"> <label class="md-nav__link" for="nav-3-6"> 排序 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-3-6"> 排序 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../basic/sort-intro/" title="排序简介" class="md-nav__link"> 排序简介 </a> </li> <li class="md-nav__item"> <a href="../../basic/selection-sort/" title="选择排序" class="md-nav__link"> 选择排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/bubble-sort/" title="冒泡排序" class="md-nav__link"> 冒泡排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/insertion-sort/" title="插入排序" class="md-nav__link"> 插入排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/counting-sort/" title="计数排序" class="md-nav__link"> 计数排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/radix-sort/" title="基数排序" class="md-nav__link"> 基数排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/quick-sort/" title="快速排序" class="md-nav__link"> 快速排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/merge-sort/" title="归并排序" class="md-nav__link"> 归并排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/heap-sort/" title="堆排序" class="md-nav__link"> 堆排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/bucket-sort/" title="桶排序" class="md-nav__link"> 桶排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/shell-sort/" title="希尔排序" class="md-nav__link"> 希尔排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/stl-sort/" title="排序相关 STL" class="md-nav__link"> 排序相关 STL </a> </li> <li class="md-nav__item"> <a href="../../basic/use-of-sort/" title="排序应用" class="md-nav__link"> 排序应用 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../basic/prefix-sum/" title="前缀和 &amp; 差分" class="md-nav__link"> 前缀和 &amp; 差分 </a> </li> <li class="md-nav__item"> <a href="../../basic/binary/" title="二分" class="md-nav__link"> 二分 </a> </li> <li class="md-nav__item"> <a href="../../basic/binary-lifting/" title="倍增" class="md-nav__link"> 倍增 </a> </li> <li class="md-nav__item"> <a href="../../basic/construction/" title="构造" class="md-nav__link"> 构造 </a> </li> <li class="md-nav__item"> <a href="../../basic/interaction/" title="交互题" class="md-nav__link"> 交互题 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"> <label class="md-nav__link" for="nav-4"> 搜索 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-4"> 搜索 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../search/" title="搜索部分简介" class="md-nav__link"> 搜索部分简介 </a> </li> <li class="md-nav__item"> <a href="../../search/dfs/" title="DFS（搜索）" class="md-nav__link"> DFS（搜索） </a> </li> <li class="md-nav__item"> <a href="../../search/bfs/" title="BFS（搜索）" class="md-nav__link"> BFS（搜索） </a> </li> <li class="md-nav__item"> <a href="../../search/bidirectional/" title="双向搜索" class="md-nav__link"> 双向搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/heuristic/" title="启发式搜索" class="md-nav__link"> 启发式搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/astar/" title="A*" class="md-nav__link"> A* </a> </li> <li class="md-nav__item"> <a href="../../search/iterative/" title="迭代加深搜索" class="md-nav__link"> 迭代加深搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/idastar/" title="IDA*" class="md-nav__link"> IDA* </a> </li> <li class="md-nav__item"> <a href="../../search/backtracking/" title="回溯法" class="md-nav__link"> 回溯法 </a> </li> <li class="md-nav__item"> <a href="../../search/dlx/" title="Dancing Links" class="md-nav__link"> Dancing Links </a> </li> <li class="md-nav__item"> <a href="../../search/opt/" title="优化" class="md-nav__link"> 优化 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"> <label class="md-nav__link" for="nav-5"> 动态规划 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-5"> 动态规划 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../dp/" title="动态规划部分简介" class="md-nav__link"> 动态规划部分简介 </a> </li> <li class="md-nav__item"> <a href="../../dp/basic/" title="动态规划基础" class="md-nav__link"> 动态规划基础 </a> </li> <li class="md-nav__item"> <a href="../../dp/memo/" title="记忆化搜索" class="md-nav__link"> 记忆化搜索 </a> </li> <li class="md-nav__item"> <a href="../../dp/knapsack/" title="背包 DP" class="md-nav__link"> 背包 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/interval/" title="区间 DP" class="md-nav__link"> 区间 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/dag/" title="DAG 上的 DP" class="md-nav__link"> DAG 上的 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/tree/" title="树形 DP" class="md-nav__link"> 树形 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/state/" title="状压 DP" class="md-nav__link"> 状压 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/number/" title="数位 DP" class="md-nav__link"> 数位 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/plug/" title="插头 DP" class="md-nav__link"> 插头 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/count/" title="计数 DP" class="md-nav__link"> 计数 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/dynamic/" title="动态 DP" class="md-nav__link"> 动态 DP </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-13" type="checkbox" id="nav-5-13"> <label class="md-nav__link" for="nav-5-13"> DP 优化 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-5-13"> DP 优化 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../dp/opt/monotonous-queue-stack/" title="单调队列/单调栈优化" class="md-nav__link"> 单调队列/单调栈优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/slope/" title="斜率优化" class="md-nav__link"> 斜率优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/quadrangle/" title="四边形不等式优化" class="md-nav__link"> 四边形不等式优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/state/" title="状态设计优化" class="md-nav__link"> 状态设计优化 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../dp/misc/" title="其它 DP 方法" class="md-nav__link"> 其它 DP 方法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"> <label class="md-nav__link" for="nav-6"> 字符串 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-6"> 字符串 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../string/" title="字符串部分简介" class="md-nav__link"> 字符串部分简介 </a> </li> <li class="md-nav__item"> <a href="../../string/basic/" title="字符串基础" class="md-nav__link"> 字符串基础 </a> </li> <li class="md-nav__item"> <a href="../../string/lib-func/" title="标准库" class="md-nav__link"> 标准库 </a> </li> <li class="md-nav__item"> <a href="../../string/match/" title="字符串匹配" class="md-nav__link"> 字符串匹配 </a> </li> <li class="md-nav__item"> <a href="../../string/hash/" title="字符串哈希" class="md-nav__link"> 字符串哈希 </a> </li> <li class="md-nav__item"> <a href="../../string/trie/" title="字典树 (Trie)" class="md-nav__link"> 字典树 (Trie) </a> </li> <li class="md-nav__item"> <a href="../../string/kmp/" title="前缀函数与 KMP 算法" class="md-nav__link"> 前缀函数与 KMP 算法 </a> </li> <li class="md-nav__item"> <a href="../../string/bm/" title="Boyer-Moore算法" class="md-nav__link"> Boyer-Moore算法 </a> </li> <li class="md-nav__item"> <a href="../../string/z-func/" title="Z 函数（扩展 KMP）" class="md-nav__link"> Z 函数（扩展 KMP） </a> </li> <li class="md-nav__item"> <a href="../../string/automaton/" title="自动机" class="md-nav__link"> 自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/ac-automaton/" title="AC 自动机" class="md-nav__link"> AC 自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/sa/" title="后缀数组 (SA)" class="md-nav__link"> 后缀数组 (SA) </a> </li> <li class="md-nav__item"> <a href="../../string/sam/" title="后缀自动机 (SAM)" class="md-nav__link"> 后缀自动机 (SAM) </a> </li> <li class="md-nav__item"> <a href="../../string/general-sam/" title="广义后缀自动机" class="md-nav__link"> 广义后缀自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/suffix-tree/" title="后缀树" class="md-nav__link"> 后缀树 </a> </li> <li class="md-nav__item"> <a href="../../string/manacher/" title="Manacher" class="md-nav__link"> Manacher </a> </li> <li class="md-nav__item"> <a href="../../string/pam/" title="回文树" class="md-nav__link"> 回文树 </a> </li> <li class="md-nav__item"> <a href="../../string/seq-automaton/" title="序列自动机" class="md-nav__link"> 序列自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/minimal-string/" title="最小表示法" class="md-nav__link"> 最小表示法 </a> </li> <li class="md-nav__item"> <a href="../../string/lyndon/" title="Lyndon 分解" class="md-nav__link"> Lyndon 分解 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7"> <label class="md-nav__link" for="nav-7"> 数学 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-7"> 数学 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/" title="数学部分简介" class="md-nav__link"> 数学部分简介 </a> </li> <li class="md-nav__item"> <a href="../../math/notation/" title="符号" class="md-nav__link"> 符号 </a> </li> <li class="md-nav__item"> <a href="../../math/complex/" title="复数" class="md-nav__link"> 复数 </a> </li> <li class="md-nav__item"> <a href="../../math/bit/" title="位运算" class="md-nav__link"> 位运算 </a> </li> <li class="md-nav__item"> <a href="../../math/quick-pow/" title="快速幂" class="md-nav__link"> 快速幂 </a> </li> <li class="md-nav__item"> <a href="../../math/base/" title="进位制" class="md-nav__link"> 进位制 </a> </li> <li class="md-nav__item"> <a href="../../math/bignum/" title="高精度计算" class="md-nav__link"> 高精度计算 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-8" type="checkbox" id="nav-7-8"> <label class="md-nav__link" for="nav-7-8"> 数论 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-8"> 数论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/prime/" title="素数" class="md-nav__link"> 素数 </a> </li> <li class="md-nav__item"> <a href="../../math/gcd/" title="最大公约数" class="md-nav__link"> 最大公约数 </a> </li> <li class="md-nav__item"> <a href="../../math/euler/" title="欧拉函数" class="md-nav__link"> 欧拉函数 </a> </li> <li class="md-nav__item"> <a href="../../math/sieve/" title="筛法" class="md-nav__link"> 筛法 </a> </li> <li class="md-nav__item"> <a href="../../math/fermat/" title="欧拉定理 &amp; 费马小定理" class="md-nav__link"> 欧拉定理 &amp; 费马小定理 </a> </li> <li class="md-nav__item"> <a href="../../math/euclidean/" title="类欧几里德算法" class="md-nav__link"> 类欧几里德算法 </a> </li> <li class="md-nav__item"> <a href="../../math/bezouts/" title="裴蜀定理" class="md-nav__link"> 裴蜀定理 </a> </li> <li class="md-nav__item"> <a href="../../math/inverse/" title="乘法逆元" class="md-nav__link"> 乘法逆元 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-equation/" title="线性同余方程" class="md-nav__link"> 线性同余方程 </a> </li> <li class="md-nav__item"> <a href="../../math/crt/" title="中国剩余定理" class="md-nav__link"> 中国剩余定理 </a> </li> <li class="md-nav__item"> <a href="../../math/bsgs/" title="BSGS" class="md-nav__link"> BSGS </a> </li> <li class="md-nav__item"> <a href="../../math/primitive-root/" title="原根" class="md-nav__link"> 原根 </a> </li> <li class="md-nav__item"> <a href="../../math/lucas/" title="卢卡斯定理" class="md-nav__link"> 卢卡斯定理 </a> </li> <li class="md-nav__item"> <a href="../../math/mobius/" title="莫比乌斯反演" class="md-nav__link"> 莫比乌斯反演 </a> </li> <li class="md-nav__item"> <a href="../../math/du/" title="杜教筛" class="md-nav__link"> 杜教筛 </a> </li> <li class="md-nav__item"> <a href="../../math/min-25/" title="Min_25 筛" class="md-nav__link"> Min_25 筛 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-9" type="checkbox" id="nav-7-9"> <label class="md-nav__link" for="nav-7-9"> 多项式 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-9"> 多项式 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/poly/intro/" title="多项式部分简介" class="md-nav__link"> 多项式部分简介 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/lagrange/" title="拉格朗日插值" class="md-nav__link"> 拉格朗日插值 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/fft/" title="快速傅里叶变换" class="md-nav__link"> 快速傅里叶变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/ntt/" title="快速数论变换" class="md-nav__link"> 快速数论变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/fwt/" title="快速沃尔什变换" class="md-nav__link"> 快速沃尔什变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/inv/" title="多项式求逆" class="md-nav__link"> 多项式求逆 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/sqrt/" title="多项式开方" class="md-nav__link"> 多项式开方 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/div-mod/" title="多项式除法|取模" class="md-nav__link"> 多项式除法|取模 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/ln-exp/" title="多项式对数函数|指数函数" class="md-nav__link"> 多项式对数函数|指数函数 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/newton/" title="多项式牛顿迭代" class="md-nav__link"> 多项式牛顿迭代 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/multipoint-eval-interpolation/" title="多项式多点求值|快速插值" class="md-nav__link"> 多项式多点求值|快速插值 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/tri-func/" title="多项式三角函数" class="md-nav__link"> 多项式三角函数 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/inv-tri-func/" title="多项式反三角函数" class="md-nav__link"> 多项式反三角函数 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-recurrence/" title="常系数齐次线性递推" class="md-nav__link"> 常系数齐次线性递推 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-10" type="checkbox" id="nav-7-10"> <label class="md-nav__link" for="nav-7-10"> 生成函数 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-10"> 生成函数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/gen-func/intro/" title="生成函数简介" class="md-nav__link"> 生成函数简介 </a> </li> <li class="md-nav__item"> <a href="../../math/gen-func/ogf/" title="普通生成函数" class="md-nav__link"> 普通生成函数 </a> </li> <li class="md-nav__item"> <a href="../../math/gen-func/egf/" title="指数生成函数" class="md-nav__link"> 指数生成函数 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-11" type="checkbox" id="nav-7-11"> <label class="md-nav__link" for="nav-7-11"> 线性代数 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-11"> 线性代数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/vector/" title="向量" class="md-nav__link"> 向量 </a> </li> <li class="md-nav__item"> <a href="../../math/matrix/" title="矩阵" class="md-nav__link"> 矩阵 </a> </li> <li class="md-nav__item"> <a href="../../math/gauss/" title="高斯消元" class="md-nav__link"> 高斯消元 </a> </li> <li class="md-nav__item"> <a href="../../math/basis/" title="线性基" class="md-nav__link"> 线性基 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-12" type="checkbox" id="nav-7-12"> <label class="md-nav__link" for="nav-7-12"> 线性规划 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-12"> 线性规划 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/linear-programming/" title="线性规划简介" class="md-nav__link"> 线性规划简介 </a> </li> <li class="md-nav__item"> <a href="../../math/simplex/" title="单纯形算法" class="md-nav__link"> 单纯形算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-13" type="checkbox" id="nav-7-13"> <label class="md-nav__link" for="nav-7-13"> 组合数学 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-13"> 组合数学 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/combination/" title="排列组合" class="md-nav__link"> 排列组合 </a> </li> <li class="md-nav__item"> <a href="../../math/catalan/" title="卡特兰数" class="md-nav__link"> 卡特兰数 </a> </li> <li class="md-nav__item"> <a href="../../math/stirling/" title="斯特林数" class="md-nav__link"> 斯特林数 </a> </li> <li class="md-nav__item"> <a href="../../math/cantor/" title="康托展开" class="md-nav__link"> 康托展开 </a> </li> <li class="md-nav__item"> <a href="../../math/inclusion-exclusion-principle/" title="容斥原理" class="md-nav__link"> 容斥原理 </a> </li> <li class="md-nav__item"> <a href="../../math/drawer-principle/" title="抽屉原理" class="md-nav__link"> 抽屉原理 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../math/expectation/" title="概率 &amp; 期望" class="md-nav__link"> 概率 &amp; 期望 </a> </li> <li class="md-nav__item"> <a href="../../math/permutation-group/" title="置换群" class="md-nav__link"> 置换群 </a> </li> <li class="md-nav__item"> <a href="../../math/fibonacci/" title="斐波那契数列" class="md-nav__link"> 斐波那契数列 </a> </li> <li class="md-nav__item"> <a href="../../math/game-theory/" title="博弈论" class="md-nav__link"> 博弈论 </a> </li> <li class="md-nav__item"> <a href="../../math/newton/" title="牛顿迭代法" class="md-nav__link"> 牛顿迭代法 </a> </li> <li class="md-nav__item"> <a href="../../math/integral/" title="数值积分" class="md-nav__link"> 数值积分 </a> </li> <li class="md-nav__item"> <a href="../../math/dictionary/" title="分段打表" class="md-nav__link"> 分段打表 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked=""> <label class="md-nav__link" for="nav-8"> 数据结构 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-8"> 数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../" title="数据结构部分简介" class="md-nav__link"> 数据结构部分简介 </a> </li> <li class="md-nav__item"> <a href="../stack/" title="栈" class="md-nav__link"> 栈 </a> </li> <li class="md-nav__item"> <a href="../queue/" title="队列" class="md-nav__link"> 队列 </a> </li> <li class="md-nav__item"> <a href="../linked-list/" title="链表" class="md-nav__link"> 链表 </a> </li> <li class="md-nav__item"> <a href="../hash/" title="哈希表" class="md-nav__link"> 哈希表 </a> </li> <li class="md-nav__item"> <a href="../dsu/" title="并查集" class="md-nav__link"> 并查集 </a> </li> <li class="md-nav__item"> <a href="../dsu-complexity/" title="并查集时间复杂度证明" class="md-nav__link"> 并查集时间复杂度证明 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8" type="checkbox" id="nav-8-8"> <label class="md-nav__link" for="nav-8-8"> 堆 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-8"> 堆 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../heap/" title="堆简介" class="md-nav__link"> 堆简介 </a> </li> <li class="md-nav__item"> <a href="../binary-heap/" title="二叉堆" class="md-nav__link"> 二叉堆 </a> </li> <li class="md-nav__item"> <a href="../pairing-heap/" title="配对堆" class="md-nav__link"> 配对堆 </a> </li> <li class="md-nav__item"> <a href="../leftist-tree/" title="左偏树" class="md-nav__link"> 左偏树 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9" type="checkbox" id="nav-8-9"> <label class="md-nav__link" for="nav-8-9"> 块状数据结构 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-9"> 块状数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../decompose/" title="分块思想" class="md-nav__link"> 分块思想 </a> </li> <li class="md-nav__item"> <a href="../block-array/" title="块状数组" class="md-nav__link"> 块状数组 </a> </li> <li class="md-nav__item"> <a href="../block-list/" title="块状链表" class="md-nav__link"> 块状链表 </a> </li> <li class="md-nav__item"> <a href="../tree-decompose/" title="树分块" class="md-nav__link"> 树分块 </a> </li> <li class="md-nav__item"> <a href="../sqrt-tree/" title="Sqrt Tree" class="md-nav__link"> Sqrt Tree </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../monotonous-stack/" title="单调栈" class="md-nav__link"> 单调栈 </a> </li> <li class="md-nav__item"> <a href="../monotonous-queue/" title="单调队列" class="md-nav__link"> 单调队列 </a> </li> <li class="md-nav__item"> <a href="../sparse-table/" title="ST 表" class="md-nav__link"> ST 表 </a> </li> <li class="md-nav__item"> <a href="../seg/" title="线段树" class="md-nav__link"> 线段树 </a> </li> <li class="md-nav__item"> <a href="../fenwick/" title="树状数组" class="md-nav__link"> 树状数组 </a> </li> <li class="md-nav__item"> <a href="../seg-beats/" title="区间最值操作 &amp; 区间历史最值" class="md-nav__link"> 区间最值操作 &amp; 区间历史最值 </a> </li> <li class="md-nav__item"> <a href="../dividing/" title="划分树" class="md-nav__link"> 划分树 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-17" type="checkbox" id="nav-8-17"> <label class="md-nav__link" for="nav-8-17"> 二叉搜索树 &amp; 平衡树 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-17"> 二叉搜索树 &amp; 平衡树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../bst/" title="二叉搜索树简介" class="md-nav__link"> 二叉搜索树简介 </a> </li> <li class="md-nav__item"> <a href="../treap/" title="Treap" class="md-nav__link"> Treap </a> </li> <li class="md-nav__item"> <a href="../splay/" title="Splay" class="md-nav__link"> Splay </a> </li> <li class="md-nav__item"> <a href="../wblt/" title="WBLT" class="md-nav__link"> WBLT </a> </li> <li class="md-nav__item"> <a href="../sbt/" title="Size Balanced Tree" class="md-nav__link"> Size Balanced Tree </a> </li> <li class="md-nav__item"> <a href="../avl/" title="AVL 树" class="md-nav__link"> AVL 树 </a> </li> <li class="md-nav__item"> <a href="../sgt/" title="替罪羊树" class="md-nav__link"> 替罪羊树 </a> </li> <li class="md-nav__item"> <a href="../cartesian-tree/" title="笛卡尔树" class="md-nav__link"> 笛卡尔树 </a> </li> <li class="md-nav__item"> <a href="../llrbt/" title="左偏红黑树" class="md-nav__link"> 左偏红黑树 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-18" type="checkbox" id="nav-8-18" checked=""> <label class="md-nav__link" for="nav-8-18"> 可持久化数据结构 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-18"> 可持久化数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../persistent/" title="可持久化数据结构简介" class="md-nav__link"> 可持久化数据结构简介 </a> </li> <li class="md-nav__item"> <a href="../persistent-seg/" title="可持久化线段树" class="md-nav__link"> 可持久化线段树 </a> </li> <li class="md-nav__item"> <a href="../persistent-block-array/" title="可持久化块状数组" class="md-nav__link"> 可持久化块状数组 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> 可持久化平衡树 </label> <a href="./" title="可持久化平衡树" class="md-nav__link md-nav__link--active"> 可持久化平衡树 </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc">目录</label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="#treap" class="md-nav__link"> 对于无旋 Treap 的提示 </a> </li> <li class="md-nav__item"> <a href="#_1" class="md-nav__link"> 思想/做法 </a> </li> <li class="md-nav__item"> <a href="#_2" class="md-nav__link"> 可持久化操作 </a> </li> <li class="md-nav__item"> <a href="#_3" class="md-nav__link"> 可持久化 </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#split" class="md-nav__link"> Split </a> </li> <li class="md-nav__item"> <a href="#merge" class="md-nav__link"> Merge </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#luogu-p3835" class="md-nav__link"> Luogu P3835 可持久化平衡树 </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_4" class="md-nav__link"> 题目背景 </a> </li> <li class="md-nav__item"> <a href="#_5" class="md-nav__link"> 题目描述 </a> </li> <li class="md-nav__item"> <a href="#_6" class="md-nav__link"> 输入格式 </a> </li> <li class="md-nav__item"> <a href="#_7" class="md-nav__link"> 输出格式 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_8" class="md-nav__link"> 题解简述 </a> </li> <li class="md-nav__item"> <a href="#_9" class="md-nav__link"> 推荐的练手题 </a> </li> <li class="md-nav__item"> <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../persistent-trie/" title="可持久化字典树" class="md-nav__link"> 可持久化字典树 </a> </li> <li class="md-nav__item"> <a href="../persistent-heap/" title="可持久化可并堆" class="md-nav__link"> 可持久化可并堆 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-19" type="checkbox" id="nav-8-19"> <label class="md-nav__link" for="nav-8-19"> 树套树 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-19"> 树套树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../seg-in-seg/" title="线段树套线段树" class="md-nav__link"> 线段树套线段树 </a> </li> <li class="md-nav__item"> <a href="../seg-in-balanced/" title="平衡树套线段树" class="md-nav__link"> 平衡树套线段树 </a> </li> <li class="md-nav__item"> <a href="../balanced-in-seg/" title="线段树套平衡树" class="md-nav__link"> 线段树套平衡树 </a> </li> <li class="md-nav__item"> <a href="../persistent-in-bit/" title="树状数组套主席树" class="md-nav__link"> 树状数组套主席树 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../kdt/" title="K-D Tree" class="md-nav__link"> K-D Tree </a> </li> <li class="md-nav__item"> <a href="../odt/" title="珂朵莉树" class="md-nav__link"> 珂朵莉树 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-22" type="checkbox" id="nav-8-22"> <label class="md-nav__link" for="nav-8-22"> 动态树 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-22"> 动态树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../lct/" title="Link Cut Tree" class="md-nav__link"> Link Cut Tree </a> </li> <li class="md-nav__item"> <a href="../ett/" title="Euler Tour Tree" class="md-nav__link"> Euler Tour Tree </a> </li> <li class="md-nav__item"> <a href="../top-tree/" title="Top Tree" class="md-nav__link"> Top Tree </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../divide-combine/" title="析合树" class="md-nav__link"> 析合树 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"> <label class="md-nav__link" for="nav-9"> 图论 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-9"> 图论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/" title="图论部分简介" class="md-nav__link"> 图论部分简介 </a> </li> <li class="md-nav__item"> <a href="../../graph/concept/" title="图论相关概念" class="md-nav__link"> 图论相关概念 </a> </li> <li class="md-nav__item"> <a href="../../graph/save/" title="图的存储" class="md-nav__link"> 图的存储 </a> </li> <li class="md-nav__item"> <a href="../../graph/dfs/" title="DFS（图论）" class="md-nav__link"> DFS（图论） </a> </li> <li class="md-nav__item"> <a href="../../graph/bfs/" title="BFS（图论）" class="md-nav__link"> BFS（图论） </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-6" type="checkbox" id="nav-9-6"> <label class="md-nav__link" for="nav-9-6"> 树上问题 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-9-6"> 树上问题 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/tree-basic/" title="树基础" class="md-nav__link"> 树基础 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-diameter/" title="树的直径" class="md-nav__link"> 树的直径 </a> </li> <li class="md-nav__item"> <a href="../../graph/lca/" title="最近公共祖先" class="md-nav__link"> 最近公共祖先 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-centroid/" title="树的重心" class="md-nav__link"> 树的重心 </a> </li> <li class="md-nav__item"> <a href="../../graph/hld/" title="树链剖分" class="md-nav__link"> 树链剖分 </a> </li> <li class="md-nav__item"> <a href="../../graph/dsu-on-tree/" title="树上启发式合并" class="md-nav__link"> 树上启发式合并 </a> </li> <li class="md-nav__item"> <a href="../../graph/virtual-tree/" title="虚树" class="md-nav__link"> 虚树 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-divide/" title="树分治" class="md-nav__link"> 树分治 </a> </li> <li class="md-nav__item"> <a href="../../graph/dynamic-tree-divide/" title="动态树分治" class="md-nav__link"> 动态树分治 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-ahu/" title="AHU算法" class="md-nav__link"> AHU算法 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-hash/" title="树哈希" class="md-nav__link"> 树哈希 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/matrix-tree/" title="矩阵树定理" class="md-nav__link"> 矩阵树定理 </a> </li> <li class="md-nav__item"> <a href="../../graph/dag/" title="有向无环图" class="md-nav__link"> 有向无环图 </a> </li> <li class="md-nav__item"> <a href="../../graph/topo/" title="拓扑排序" class="md-nav__link"> 拓扑排序 </a> </li> <li class="md-nav__item"> <a href="../../graph/mst/" title="最小生成树" class="md-nav__link"> 最小生成树 </a> </li> <li class="md-nav__item"> <a href="../../graph/mdst/" title="最小树形图" class="md-nav__link"> 最小树形图 </a> </li> <li class="md-nav__item"> <a href="../../graph/shortest-path/" title="最短路" class="md-nav__link"> 最短路 </a> </li> <li class="md-nav__item"> <a href="../../graph/node/" title="拆点" class="md-nav__link"> 拆点 </a> </li> <li class="md-nav__item"> <a href="../../graph/diff-constraints/" title="差分约束" class="md-nav__link"> 差分约束 </a> </li> <li class="md-nav__item"> <a href="../../graph/kth-path/" title="k 短路" class="md-nav__link"> k 短路 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-16" type="checkbox" id="nav-9-16"> <label class="md-nav__link" for="nav-9-16"> 连通性相关 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-9-16"> 连通性相关 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/scc/" title="强连通分量" class="md-nav__link"> 强连通分量 </a> </li> <li class="md-nav__item"> <a href="../../graph/bcc/" title="双连通分量" class="md-nav__link"> 双连通分量 </a> </li> <li class="md-nav__item"> <a href="../../graph/cut/" title="割点和桥" class="md-nav__link"> 割点和桥 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/2-sat/" title="2-SAT" class="md-nav__link"> 2-SAT </a> </li> <li class="md-nav__item"> <a href="../../graph/euler/" title="欧拉图" class="md-nav__link"> 欧拉图 </a> </li> <li class="md-nav__item"> <a href="../../graph/hamilton/" title="哈密顿图" class="md-nav__link"> 哈密顿图 </a> </li> <li class="md-nav__item"> <a href="../../graph/bi-graph/" title="二分图" class="md-nav__link"> 二分图 </a> </li> <li class="md-nav__item"> <a href="../../graph/min-circle/" title="最小环" class="md-nav__link"> 最小环 </a> </li> <li class="md-nav__item"> <a href="../../graph/planar/" title="平面图" class="md-nav__link"> 平面图 </a> </li> <li class="md-nav__item"> <a href="../../graph/color/" title="图的着色" class="md-nav__link"> 图的着色 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-24" type="checkbox" id="nav-9-24"> <label class="md-nav__link" for="nav-9-24"> 网络流 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-9-24"> 网络流 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/flow/" title="网络流简介" class="md-nav__link"> 网络流简介 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/max-flow/" title="最大流" class="md-nav__link"> 最大流 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/min-cut/" title="最小割" class="md-nav__link"> 最小割 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/min-cost/" title="费用流" class="md-nav__link"> 费用流 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/bound/" title="上下界网络流" class="md-nav__link"> 上下界网络流 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/prufer/" title="Prufer 序列" class="md-nav__link"> Prufer 序列 </a> </li> <li class="md-nav__item"> <a href="../../graph/lgv/" title="LGV 引理" class="md-nav__link"> LGV 引理 </a> </li> <li class="md-nav__item"> <a href="../../graph/chord/" title="弦图" class="md-nav__link"> 弦图 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"> <label class="md-nav__link" for="nav-10"> 计算几何 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-10"> 计算几何 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../geometry/" title="计算几何部分简介" class="md-nav__link"> 计算几何部分简介 </a> </li> <li class="md-nav__item"> <a href="../../geometry/2d/" title="二维计算几何基础" class="md-nav__link"> 二维计算几何基础 </a> </li> <li class="md-nav__item"> <a href="../../geometry/3d/" title="三维计算几何基础" class="md-nav__link"> 三维计算几何基础 </a> </li> <li class="md-nav__item"> <a href="../../geometry/polar-coordinate/" title="极坐标系" class="md-nav__link"> 极坐标系 </a> </li> <li class="md-nav__item"> <a href="../../geometry/distance/" title="距离" class="md-nav__link"> 距离 </a> </li> <li class="md-nav__item"> <a href="../../geometry/pick/" title="Pick 定理" class="md-nav__link"> Pick 定理 </a> </li> <li class="md-nav__item"> <a href="../../geometry/triangulation/" title="三角剖分" class="md-nav__link"> 三角剖分 </a> </li> <li class="md-nav__item"> <a href="../../geometry/convex-hull/" title="凸包" class="md-nav__link"> 凸包 </a> </li> <li class="md-nav__item"> <a href="../../geometry/scanning/" title="扫描线" class="md-nav__link"> 扫描线 </a> </li> <li class="md-nav__item"> <a href="../../geometry/rotating-calipers/" title="旋转卡壳" class="md-nav__link"> 旋转卡壳 </a> </li> <li class="md-nav__item"> <a href="../../geometry/half-plane/" title="半平面交" class="md-nav__link"> 半平面交 </a> </li> <li class="md-nav__item"> <a href="../../geometry/nearest-points/" title="平面最近点对" class="md-nav__link"> 平面最近点对 </a> </li> <li class="md-nav__item"> <a href="../../geometry/random-incremental/" title="随机增量法" class="md-nav__link"> 随机增量法 </a> </li> <li class="md-nav__item"> <a href="../../geometry/inverse/" title="反演变换" class="md-nav__link"> 反演变换 </a> </li> <li class="md-nav__item"> <a href="../../geometry/misc/" title="计算几何杂项" class="md-nav__link"> 计算几何杂项 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11"> <label class="md-nav__link" for="nav-11"> 杂项 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-11"> 杂项 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/" title="杂项简介" class="md-nav__link"> 杂项简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/io/" title="读入、输出优化" class="md-nav__link"> 读入、输出优化 </a> </li> <li class="md-nav__item"> <a href="../../misc/complexity/" title="复杂度" class="md-nav__link"> 复杂度 </a> </li> <li class="md-nav__item"> <a href="../../misc/discrete/" title="离散化" class="md-nav__link"> 离散化 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-5" type="checkbox" id="nav-11-5"> <label class="md-nav__link" for="nav-11-5"> 离线算法 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-11-5"> 离线算法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/offline/" title="离线算法简介" class="md-nav__link"> 离线算法简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/cdq-divide/" title="CDQ 分治" class="md-nav__link"> CDQ 分治 </a> </li> <li class="md-nav__item"> <a href="../../misc/parallel-binsearch/" title="整体二分" class="md-nav__link"> 整体二分 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-5-4" type="checkbox" id="nav-11-5-4"> <label class="md-nav__link" for="nav-11-5-4"> 莫队算法 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-11-5-4"> 莫队算法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/mo-algo-intro/" title="莫队算法简介" class="md-nav__link"> 莫队算法简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo/" title="普通莫队算法" class="md-nav__link"> 普通莫队算法 </a> </li> <li class="md-nav__item"> <a href="../../misc/modifiable-mo-algo/" title="带修改莫队" class="md-nav__link"> 带修改莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-on-tree/" title="树上莫队" class="md-nav__link"> 树上莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/rollback-mo-algo/" title="回滚莫队" class="md-nav__link"> 回滚莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-with-bitset/" title="莫队配合bitset" class="md-nav__link"> 莫队配合bitset </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../misc/frac-programming/" title="分数规划" class="md-nav__link"> 分数规划 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-7" type="checkbox" id="nav-11-7"> <label class="md-nav__link" for="nav-11-7"> 随机化 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-11-7"> 随机化 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/random/" title="随机函数" class="md-nav__link"> 随机函数 </a> </li> <li class="md-nav__item"> <a href="../../misc/hill-climbing/" title="爬山算法" class="md-nav__link"> 爬山算法 </a> </li> <li class="md-nav__item"> <a href="../../misc/simulated-annealing/" title="模拟退火" class="md-nav__link"> 模拟退火 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../misc/hoverline/" title="悬线法" class="md-nav__link"> 悬线法 </a> </li> <li class="md-nav__item"> <a href="../../misc/cc-basic/" title="计算理论基础" class="md-nav__link"> 计算理论基础 </a> </li> <li class="md-nav__item"> <a href="../../misc/endianness/" title="字节顺序" class="md-nav__link"> 字节顺序 </a> </li> <li class="md-nav__item"> <a href="../../misc/josephus/" title="约瑟夫问题" class="md-nav__link"> 约瑟夫问题 </a> </li> <li class="md-nav__item"> <a href="../../misc/stern-brocot/" title="Stern-Brocot 树与 Farey 序列" class="md-nav__link"> Stern-Brocot 树与 Farey 序列 </a> </li> <li class="md-nav__item"> <a href="../../misc/gray-code/" title="格雷码" class="md-nav__link"> 格雷码 </a> </li> <li class="md-nav__item"> <a href="../../misc/expression/" title="表达式求值" class="md-nav__link"> 表达式求值 </a> </li> <li class="md-nav__item"> <a href="../../misc/job-order/" title="在一台机器上规划任务" class="md-nav__link"> 在一台机器上规划任务 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12"> <label class="md-nav__link" for="nav-12"> 专题 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-12"> 专题 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../topic/rmq/" title="RMQ" class="md-nav__link"> RMQ </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12-2" type="checkbox" id="nav-12-2"> <label class="md-nav__link" for="nav-12-2"> 图的匹配 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-12-2"> 图的匹配 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../topic/graph-matching/graph-match/" title="图匹配" class="md-nav__link"> 图匹配 </a> </li> <li class="md-nav__item"> <a href="../../topic/graph-matching/augment/" title="增广路" class="md-nav__link"> 增广路 </a> </li> <li class="md-nav__item"> <a href="../../topic/graph-matching/bigraph-match/" title="二分图最大匹配" class="md-nav__link"> 二分图最大匹配 </a> </li> <li class="md-nav__item"> <a href="../../topic/graph-matching/general-match/" title="一般图匹配" class="md-nav__link"> 一般图匹配 </a> </li> <li class="md-nav__item"> <a href="../../topic/graph-matching/bigraph-weight-match/" title="二分图最大权匹配" class="md-nav__link"> 二分图最大权匹配 </a> </li> <li class="md-nav__item"> <a href="../../topic/graph-matching/general-weight-match/" title="一般图最大权匹配" class="md-nav__link"> 一般图最大权匹配 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../topic/problemsetting/" title="出题" class="md-nav__link"> 出题 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13"> <label class="md-nav__link" for="nav-13"> 关于 Hulu </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-13"> 关于 Hulu </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../intro/hulu/" title="关于 Hulu" class="md-nav__link"> 关于 Hulu </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc">目录</label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="#treap" class="md-nav__link"> 对于无旋 Treap 的提示 </a> </li> <li class="md-nav__item"> <a href="#_1" class="md-nav__link"> 思想/做法 </a> </li> <li class="md-nav__item"> <a href="#_2" class="md-nav__link"> 可持久化操作 </a> </li> <li class="md-nav__item"> <a href="#_3" class="md-nav__link"> 可持久化 </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#split" class="md-nav__link"> Split </a> </li> <li class="md-nav__item"> <a href="#merge" class="md-nav__link"> Merge </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#luogu-p3835" class="md-nav__link"> Luogu P3835 可持久化平衡树 </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_4" class="md-nav__link"> 题目背景 </a> </li> <li class="md-nav__item"> <a href="#_5" class="md-nav__link"> 题目描述 </a> </li> <li class="md-nav__item"> <a href="#_6" class="md-nav__link"> 输入格式 </a> </li> <li class="md-nav__item"> <a href="#_7" class="md-nav__link"> 输出格式 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_8" class="md-nav__link"> 题解简述 </a> </li> <li class="md-nav__item"> <a href="#_9" class="md-nav__link"> 推荐的练手题 </a> </li> <li class="md-nav__item"> <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content"> <article class="md-content__inner md-typeset"> <a href="https://oi-wiki.org/edit-landing/?ref=/ds/persistent-balanced.md" title="编辑此页" class="md-icon md-content__icon"></a> <h1>可持久化平衡树</h1> <p>Split-Merge Treap</p> <hr> <h2 id="treap">对于无旋 Treap 的提示<a class="headerlink" href="#treap" title="Permanent link">¶</a></h2> <p>看楼上的 <a href="../treap/">Treap 词条</a> </p> <p><strong>OI 常用的可持久化平衡树</strong> 一般就是 <strong>可持久化无旋转 Treap</strong> 所以推荐首先学习楼上的 <strong>无旋转 Treap</strong> </p> <h2 id="_1">思想/做法<a class="headerlink" href="#_1" title="Permanent link">¶</a></h2> <p>我们来看看旋转的 Treap，为什么不能可持久化呢？</p> <p>如果带旋转，那么就会 <strong>破环原有的父子关系</strong> ，破环原有的路径和树形态，这是可持久化无法接受的。</p> <p>如果把 Treap 变为非旋转的，我们发现可以通过可持久化 <strong>Merge</strong> 和 <strong>Split</strong> 操作就可以完成可持久化。</p> <p>「一切可支持操作都可以通过 <strong>Merge Split Newnode Build</strong> 完成」，而 <strong>Build</strong> 操作只用于建造无需理会， <strong>Newnode</strong> （新建节点）就是用来可持久化的工具。</p> <p>我们来观察一下 <strong>Merge</strong> 和 <strong>Split</strong> ，我们会发现它们都是由上而下的操作！</p> <p>因此我们完全可以 <strong>参考线段树的可持久化操作</strong> 对它进行可持久化。</p> <h2 id="_2">可持久化操作<a class="headerlink" href="#_2" title="Permanent link">¶</a></h2> <p><strong>可持久化</strong> 是对 <strong>数据结构</strong> 的一种操作，即保留历史信息，使得在后面可以调用之前的历史版本。</p> <p>对于 <strong>可持久化线段树</strong> 来说，每一次新建历史版本就是把 <strong>沿途的修改路径</strong> 复制出来</p> <p>那么对可持久化 Treap（目前国内 OI 常用的版本）来说：</p> <p>在复制一个节点 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.026ex" height="2.259ex" style="vertical-align:-.505ex" viewBox="0 -755.5 1302.9 972.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title"> <title id="MathJax-SVG-1-Title">X_{a}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E1-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> <path stroke-width="1" id="E1-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E1-MJMATHI-58" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-61" x="1171" y="-213"></use> </g> </svg></span></span> ( <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.009ex" style="vertical-align:-.255ex" viewBox="0 -755.5 852.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-2-Title"> <title id="MathJax-SVG-2-Title">X</title> <defs aria-hidden="true"> <path stroke-width="1" id="E2-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E2-MJMATHI-58" x="0" y="0"></use> </g> </svg></span></span> 节点的第 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" style="vertical-align:-.255ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-3-Title"> <title id="MathJax-SVG-3-Title">a</title> <defs aria-hidden="true"> <path stroke-width="1" id="E3-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E3-MJMATHI-61" x="0" y="0"></use> </g> </svg></span></span> 个版本）的新版本 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.127ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 2207.3 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-4-Title"> <title id="MathJax-SVG-4-Title">X_{a+1}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E4-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> <path stroke-width="1" id="E4-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E4-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E4-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E4-MJMATHI-58" x="0" y="0"></use> <g transform="translate(828,-150)"> <use transform="scale(0.707)" xlink:href="#E4-MJMATHI-61" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E4-MJMAIN-2B" x="529" y="0"></use> <use transform="scale(0.707)" xlink:href="#E4-MJMAIN-31" x="1308" y="0"></use> </g> </g> </svg></span></span> ( <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.009ex" style="vertical-align:-.255ex" viewBox="0 -755.5 852.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-5-Title"> <title id="MathJax-SVG-5-Title">X</title> <defs aria-hidden="true"> <path stroke-width="1" id="E5-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E5-MJMATHI-58" x="0" y="0"></use> </g> </svg></span></span> 节点的第 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.233ex" height="2.134ex" style="vertical-align:-.38ex" viewBox="0 -755.5 2252.9 918.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-6-Title"> <title id="MathJax-SVG-6-Title">a+1</title> <defs aria-hidden="true"> <path stroke-width="1" id="E6-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E6-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E6-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E6-MJMATHI-61" x="0" y="0"></use> <use xlink:href="#E6-MJMAIN-2B" x="751" y="0"></use> <use xlink:href="#E6-MJMAIN-31" x="1752" y="0"></use> </g> </svg></span></span> 个版本）以后：</p> <ul> <li>如果某个儿子节点 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.884ex" style="vertical-align:-.13ex" viewBox="0 -755.5 763.5 811.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-7-Title"> <title id="MathJax-SVG-7-Title">Y</title> <defs aria-hidden="true"> <path stroke-width="1" id="E7-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E7-MJMATHI-59" x="0" y="0"></use> </g> </svg></span></span> 不用修改信息，那么就把 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.127ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 2207.3 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-8-Title"> <title id="MathJax-SVG-8-Title">X_{a+1}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E8-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> <path stroke-width="1" id="E8-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E8-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E8-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E8-MJMATHI-58" x="0" y="0"></use> <g transform="translate(828,-150)"> <use transform="scale(0.707)" xlink:href="#E8-MJMATHI-61" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E8-MJMAIN-2B" x="529" y="0"></use> <use transform="scale(0.707)" xlink:href="#E8-MJMAIN-31" x="1308" y="0"></use> </g> </g> </svg></span></span> 的指针直接指向 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.452ex" height="2.259ex" style="vertical-align:-.505ex" viewBox="0 -755.5 1055.9 972.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-9-Title"> <title id="MathJax-SVG-9-Title">Y_{a}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E9-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> <path stroke-width="1" id="E9-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E9-MJMATHI-59" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E9-MJMATHI-61" x="822" y="-213"></use> </g> </svg></span></span> ( <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.884ex" style="vertical-align:-.13ex" viewBox="0 -755.5 763.5 811.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-10-Title"> <title id="MathJax-SVG-10-Title">Y</title> <defs aria-hidden="true"> <path stroke-width="1" id="E10-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E10-MJMATHI-59" x="0" y="0"></use> </g> </svg></span></span> 节点的第 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" style="vertical-align:-.255ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-11-Title"> <title id="MathJax-SVG-11-Title">a</title> <defs aria-hidden="true"> <path stroke-width="1" id="E11-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E11-MJMATHI-61" x="0" y="0"></use> </g> </svg></span></span> 个版本）即可。</li> <li>反之，如果要修改 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.884ex" style="vertical-align:-.13ex" viewBox="0 -755.5 763.5 811.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-12-Title"> <title id="MathJax-SVG-12-Title">Y</title> <defs aria-hidden="true"> <path stroke-width="1" id="E12-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E12-MJMATHI-59" x="0" y="0"></use> </g> </svg></span></span> ，那么就在 <strong>递归到下层</strong> 时 <strong>新建</strong> <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.553ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 1960.3 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-13-Title"> <title id="MathJax-SVG-13-Title">Y_{a+1}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E13-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> <path stroke-width="1" id="E13-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E13-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E13-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E13-MJMATHI-59" x="0" y="0"></use> <g transform="translate(581,-150)"> <use transform="scale(0.707)" xlink:href="#E13-MJMATHI-61" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E13-MJMAIN-2B" x="529" y="0"></use> <use transform="scale(0.707)" xlink:href="#E13-MJMAIN-31" x="1308" y="0"></use> </g> </g> </svg></span></span> ( <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.884ex" style="vertical-align:-.13ex" viewBox="0 -755.5 763.5 811.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-14-Title"> <title id="MathJax-SVG-14-Title">Y</title> <defs aria-hidden="true"> <path stroke-width="1" id="E14-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E14-MJMATHI-59" x="0" y="0"></use> </g> </svg></span></span> 节点的第 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.233ex" height="2.134ex" style="vertical-align:-.38ex" viewBox="0 -755.5 2252.9 918.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-15-Title"> <title id="MathJax-SVG-15-Title">a+1</title> <defs aria-hidden="true"> <path stroke-width="1" id="E15-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E15-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E15-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E15-MJMATHI-61" x="0" y="0"></use> <use xlink:href="#E15-MJMAIN-2B" x="751" y="0"></use> <use xlink:href="#E15-MJMAIN-31" x="1752" y="0"></use> </g> </svg></span></span> 个版本）这个新节点用于 <strong>存储新的信息</strong> ，同时把 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.127ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 2207.3 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-16-Title"> <title id="MathJax-SVG-16-Title">X_{a+1}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E16-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path> <path stroke-width="1" id="E16-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E16-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E16-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E16-MJMATHI-58" x="0" y="0"></use> <g transform="translate(828,-150)"> <use transform="scale(0.707)" xlink:href="#E16-MJMATHI-61" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E16-MJMAIN-2B" x="529" y="0"></use> <use transform="scale(0.707)" xlink:href="#E16-MJMAIN-31" x="1308" y="0"></use> </g> </g> </svg></span></span> 的指针指向 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.553ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 1960.3 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-17-Title"> <title id="MathJax-SVG-17-Title">Y_{a+1}</title> <defs aria-hidden="true"> <path stroke-width="1" id="E17-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> <path stroke-width="1" id="E17-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E17-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E17-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E17-MJMATHI-59" x="0" y="0"></use> <g transform="translate(581,-150)"> <use transform="scale(0.707)" xlink:href="#E17-MJMATHI-61" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E17-MJMAIN-2B" x="529" y="0"></use> <use transform="scale(0.707)" xlink:href="#E17-MJMAIN-31" x="1308" y="0"></use> </g> </g> </svg></span></span> ( <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.884ex" style="vertical-align:-.13ex" viewBox="0 -755.5 763.5 811.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-18-Title"> <title id="MathJax-SVG-18-Title">Y</title> <defs aria-hidden="true"> <path stroke-width="1" id="E18-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E18-MJMATHI-59" x="0" y="0"></use> </g> </svg></span></span> 节点的第 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.233ex" height="2.134ex" style="vertical-align:-.38ex" viewBox="0 -755.5 2252.9 918.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-19-Title"> <title id="MathJax-SVG-19-Title">a+1</title> <defs aria-hidden="true"> <path stroke-width="1" id="E19-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path> <path stroke-width="1" id="E19-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path> <path stroke-width="1" id="E19-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E19-MJMATHI-61" x="0" y="0"></use> <use xlink:href="#E19-MJMAIN-2B" x="751" y="0"></use> <use xlink:href="#E19-MJMAIN-31" x="1752" y="0"></use> </g> </svg></span></span> 个版本）。</li> </ul> <h2 id="_3">可持久化<a class="headerlink" href="#_3" title="Permanent link">¶</a></h2> <p>需要的东西：</p> <ul> <li> <p>一个 struct 数组 存 <strong>每个节点</strong> 的信息（一般叫做 tree 数组）；（当然写 <strong>指针版</strong> 平衡树的大佬就可以考虑不用这个数组了）</p> </li> <li> <p>一个 <strong>根节点数组</strong> ，存每个版本的_树根_，每次查询版本信息时就从 <strong>根数组存的节点</strong> 开始；</p> </li> <li> <p>split() 分裂 <strong>从树中分裂出两棵树</strong> </p> </li> <li> <p>merge() 合并 <strong>把两棵树按照随机权值合并</strong> </p> </li> <li> <p>newNode() 新建一个节点</p> </li> <li> <p>build() 建树</p> </li> </ul> <h3 id="split">Split<a class="headerlink" href="#split" title="Permanent link">¶</a></h3> <p>对于 <strong>分裂操作</strong> ，每次分裂路径时 <strong>新建节点</strong> 指向分出来的路径，用 <code>std::pair</code> 存新分裂出来的两棵树的根。</p> <p><code>split(x,k)</code> 返回一个 <code>std::pair</code> ;</p> <p>表示把 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="1.134ex" style="vertical-align:-.505ex" viewBox="0 -271.1 504.8 488.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-20-Title"> <title id="MathJax-SVG-20-Title">_x</title> <defs aria-hidden="true"> <path stroke-width="1" id="E20-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use transform="scale(0.707)" xlink:href="#E20-MJMATHI-78" x="0" y="-213"></use> </g> </svg></span></span> 为根的树的前 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.009ex" style="vertical-align:-.255ex" viewBox="0 -755.5 521.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-21-Title"> <title id="MathJax-SVG-21-Title">k</title> <defs aria-hidden="true"> <path stroke-width="1" id="E21-MJMATHI-6B" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E21-MJMATHI-6B" x="0" y="0"></use> </g> </svg></span></span> 个元素放在 <strong>一棵树</strong> 中，剩下的节点构成在另一棵树中，返回这两棵树的根（first 是第一棵树的根，second 是第二棵树的）。</p> <ul> <li>如果 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.509ex" style="vertical-align:-.255ex" viewBox="0 -540.2 572.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-22-Title"> <title id="MathJax-SVG-22-Title">x</title> <defs aria-hidden="true"> <path stroke-width="1" id="E22-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E22-MJMATHI-78" x="0" y="0"></use> </g> </svg></span></span> 的 <strong>左子树</strong> 的 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.76ex" height="2.384ex" style="vertical-align:-.63ex" viewBox="0 -755.5 3341.1 1026.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-23-Title"> <title id="MathJax-SVG-23-Title">key ≥ k</title> <defs aria-hidden="true"> <path stroke-width="1" id="E23-MJMATHI-6B" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path> <path stroke-width="1" id="E23-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path> <path stroke-width="1" id="E23-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E23-MJMAIN-2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E23-MJMATHI-6B" x="0" y="0"></use> <use xlink:href="#E23-MJMATHI-65" x="521" y="0"></use> <use xlink:href="#E23-MJMATHI-79" x="988" y="0"></use> <use xlink:href="#E23-MJMAIN-2265" x="1763" y="0"></use> <use xlink:href="#E23-MJMATHI-6B" x="2819" y="0"></use> </g> </svg></span></span> ，那么 <strong>直接递归进左子树</strong> ，把左子树分出来的第二颗树和当前的 x <strong>右子树</strong> 合并。</li> <li>否则递归 <strong>右子树</strong> 。</li> </ul> <div class="highlight"><pre><span></span><code><span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">_split</span><span class="p">(</span><span class="kt">int</span> <span class="n">_x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">_vs</span> <span class="o">=</span> <span class="o">++</span><span class="n">_cnt</span><span class="p">;</span>  <span class="c1">// 新建节点（可持久化的精髓）</span>
    <span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">]</span> <span class="o">=</span> <span class="n">_trp</span><span class="p">[</span><span class="n">_x</span><span class="p">];</span>
    <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">_y</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">key</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">_y</span> <span class="o">=</span> <span class="n">_split</span><span class="p">(</span><span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="p">);</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">_y</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
      <span class="n">_y</span><span class="p">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">_vs</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">_y</span> <span class="o">=</span> <span class="n">_split</span><span class="p">(</span><span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">);</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_y</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
      <span class="n">_y</span><span class="p">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">_vs</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">_trp</span><span class="p">[</span><span class="n">_vs</span><span class="p">].</span><span class="n">_update</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">_y</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <h3 id="merge">Merge<a class="headerlink" href="#merge" title="Permanent link">¶</a></h3> <p>int merge(x,y) 返回 merge 出的树的根。</p> <p>同样递归实现。如果 <strong>x 的随机权值</strong> &gt; <strong>y 的随机权值</strong> ，则 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.386ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 5763.5 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-24-Title"> <title id="MathJax-SVG-24-Title">merge(x_{rc},y)</title> <defs aria-hidden="true"> <path stroke-width="1" id="E24-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E24-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path> <path stroke-width="1" id="E24-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E24-MJMATHI-67" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path> <path stroke-width="1" id="E24-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path> <path stroke-width="1" id="E24-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path> <path stroke-width="1" id="E24-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path> <path stroke-width="1" id="E24-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path> <path stroke-width="1" id="E24-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E24-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E24-MJMATHI-6D" x="0" y="0"></use> <use xlink:href="#E24-MJMATHI-65" x="878" y="0"></use> <use xlink:href="#E24-MJMATHI-72" x="1345" y="0"></use> <use xlink:href="#E24-MJMATHI-67" x="1796" y="0"></use> <use xlink:href="#E24-MJMATHI-65" x="2277" y="0"></use> <use xlink:href="#E24-MJMAIN-28" x="2743" y="0"></use> <g transform="translate(3133,0)"> <use xlink:href="#E24-MJMATHI-78" x="0" y="0"></use> <g transform="translate(572,-150)"> <use transform="scale(0.707)" xlink:href="#E24-MJMATHI-72" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E24-MJMATHI-63" x="451" y="0"></use> </g> </g> <use xlink:href="#E24-MJMAIN-2C" x="4431" y="0"></use> <use xlink:href="#E24-MJMATHI-79" x="4876" y="0"></use> <use xlink:href="#E24-MJMAIN-29" x="5373" y="0"></use> </g> </svg></span></span> ，否则 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.119ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 5648.3 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-25-Title"> <title id="MathJax-SVG-25-Title">merge(x,y_{lc})</title> <defs aria-hidden="true"> <path stroke-width="1" id="E25-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E25-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path> <path stroke-width="1" id="E25-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E25-MJMATHI-67" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path> <path stroke-width="1" id="E25-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path> <path stroke-width="1" id="E25-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path> <path stroke-width="1" id="E25-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path> <path stroke-width="1" id="E25-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path> <path stroke-width="1" id="E25-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path> <path stroke-width="1" id="E25-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path> <path stroke-width="1" id="E25-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E25-MJMATHI-6D" x="0" y="0"></use> <use xlink:href="#E25-MJMATHI-65" x="878" y="0"></use> <use xlink:href="#E25-MJMATHI-72" x="1345" y="0"></use> <use xlink:href="#E25-MJMATHI-67" x="1796" y="0"></use> <use xlink:href="#E25-MJMATHI-65" x="2277" y="0"></use> <use xlink:href="#E25-MJMAIN-28" x="2743" y="0"></use> <use xlink:href="#E25-MJMATHI-78" x="3133" y="0"></use> <use xlink:href="#E25-MJMAIN-2C" x="3705" y="0"></use> <g transform="translate(4150,0)"> <use xlink:href="#E25-MJMATHI-79" x="0" y="0"></use> <g transform="translate(490,-150)"> <use transform="scale(0.707)" xlink:href="#E25-MJMATHI-6C" x="0" y="0"></use> <use transform="scale(0.707)" xlink:href="#E25-MJMATHI-63" x="298" y="0"></use> </g> </g> <use xlink:href="#E25-MJMAIN-29" x="5258" y="0"></use> </g> </svg></span></span> 。</p> <div class="highlight"><pre><span></span><code><span class="k">static</span> <span class="kt">int</span> <span class="nf">_merge</span><span class="p">(</span><span class="kt">int</span> <span class="n">_x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_y</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">_y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_x</span> <span class="o">^</span> <span class="n">_y</span><span class="p">;</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_trp</span><span class="p">[</span><span class="n">_x</span><span class="p">].</span><span class="n">fix</span> <span class="o">&lt;</span> <span class="n">_trp</span><span class="p">[</span><span class="n">_y</span><span class="p">].</span><span class="n">fix</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_x</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">_merge</span><span class="p">(</span><span class="n">_trp</span><span class="p">[</span><span class="n">_x</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_y</span><span class="p">);</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_x</span><span class="p">].</span><span class="n">_update</span><span class="p">();</span>
      <span class="k">return</span> <span class="n">_x</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_y</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_merge</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_trp</span><span class="p">[</span><span class="n">_y</span><span class="p">].</span><span class="n">leaf</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="n">_trp</span><span class="p">[</span><span class="n">_y</span><span class="p">].</span><span class="n">_update</span><span class="p">();</span>
      <span class="k">return</span> <span class="n">_y</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <h2 id="luogu-p3835">Luogu P3835 可持久化平衡树<a class="headerlink" href="#luogu-p3835" title="Permanent link">¶</a></h2> <h3 id="_4">题目背景<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3> <p>本题为题目 <strong>普通平衡树</strong> 的可持久化加强版。</p> <p>数据已经经过强化</p> <h3 id="_5">题目描述<a class="headerlink" href="#_5" title="Permanent link">¶</a></h3> <p>您需要写一种数据结构（可参考题目标题），来维护一些数，其中需要提供以下操作（对于各个以往的历史版本）：</p> <ol> <li> <p>插入 x 数</p> </li> <li> <p>删除 x 数（若有多个相同的数，因只删除一个，如果没有请忽略该操作）</p> </li> <li> <p>查询 x 数的排名（排名定义为比当前数小的数的个数 + 1。若有多个相同的数，因输出最小的排名）</p> </li> <li> <p>查询排名为 x 的数</p> </li> <li> <p>求 x 的前驱（前驱定义为小于 x，且最大的数，如不存在输出 -2147483647）</p> </li> <li> <p>求 x 的后继（后继定义为大于 x，且最小的数，如不存在输出 2147483647）</p> </li> </ol> <p>和原本平衡树不同的一点是，每一次的任何操作都是基于某一个历史版本，同时生成一个新的版本（操作 3, 4, 5, 6 即保持原版本无变化）。</p> <p>每个版本的编号即为操作的序号（版本 0 即为初始状态，空树）</p> <h3 id="_6">输入格式<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3> <p>第一行为 n，表示操作的个数，下面 n 行每行有两个数 opt 和 x，opt 表示操作的序号 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.438ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 5785.6 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-26-Title"> <title id="MathJax-SVG-26-Title">(1 \leq x \leq le6)</title> <defs aria-hidden="true"> <path stroke-width="1" id="E26-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path> <path stroke-width="1" id="E26-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path> <path stroke-width="1" id="E26-MJMAIN-2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path> <path stroke-width="1" id="E26-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path> <path stroke-width="1" id="E26-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path> <path stroke-width="1" id="E26-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path> <path stroke-width="1" id="E26-MJMAIN-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path> <path stroke-width="1" id="E26-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path> </defs> <g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E26-MJMAIN-28" x="0" y="0"></use> <use xlink:href="#E26-MJMAIN-31" x="389" y="0"></use> <use xlink:href="#E26-MJMAIN-2264" x="1167" y="0"></use> <use xlink:href="#E26-MJMATHI-78" x="2224" y="0"></use> <use xlink:href="#E26-MJMAIN-2264" x="3074" y="0"></use> <use xlink:href="#E26-MJMATHI-6C" x="4130" y="0"></use> <use xlink:href="#E26-MJMATHI-65" x="4429" y="0"></use> <use xlink:href="#E26-MJMAIN-36" x="4895" y="0"></use> <use xlink:href="#E26-MJMAIN-29" x="5396" y="0"></use> </g> </svg></span></span> 。</p> <h3 id="_7">输出格式<a class="headerlink" href="#_7" title="Permanent link">¶</a></h3> <p>对于操作 3,4,5,6 每行输出一个数，表示对应答案。</p> <h2 id="_8">题解简述<a class="headerlink" href="#_8" title="Permanent link">¶</a></h2> <p>就是 <strong>普通平衡树</strong> 一题的可持久化版，操作和该题类似……</p> <p>只是使用了可持久化的 merge 和 split 操作</p> <h2 id="_9">推荐的练手题<a class="headerlink" href="#_9" title="Permanent link">¶</a></h2> <ol> <li> <p><a href="https://www.luogu.com.cn/problem/P3919">「Luogu P3919」可持久化数组（模板题）</a> </p> </li> <li> <p><a href="http://codeforces.com/problemset/problem/702/F">「Codeforces 702F」T-shirt</a> </p> </li> <li> <p><a href="https://www.luogu.com.cn/problem/P5055">「Luogu P5055」可持久化文艺平衡树</a> </p> </li> </ol> <hr><blockquote class="page-copyright"> <span><i class="md-icon">build</i>本页面最近更新：</span><span class="facts_modified"></span>，<a class="edit_history">更新历史</a><br> <span><i class="md-icon">edit</i>发现错误？想一起完善？ <a href="https://oi-wiki.org/edit-landing/?ref=/ds/persistent-balanced.md" title="编辑此页" class="page_edit_url">在 GitHub 上编辑此页！</a></span><br> <span><i class="md-icon">people</i>本页面贡献者：</span><span class="page_contributors">OI-wiki</span><br> <span><i class="md-icon">copyright</i>本页面的全部内容在 <strong><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span> </blockquote> <h2 id="__comments" data-no-instant="">评论</h2> <form id="gitalk-form" onsubmit="return!1" data-no-instant=""> <div id="gitalk-container" data-no-instant=""> </div> </form> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/OI-wiki/gitalk@master/dist/gitalk.css"> <script src="https://cdn.jsdelivr.net/gh/OI-wiki/gitalk@master/dist/gitalk.min.js"></script> <script> const gitalk = new Gitalk({
    id: '可持久化平衡树',
    owner: 'OI-wiki',
    repo: 'gitment',
    admin: ['Ir1d', 'cjsoft', 'TrisolarisHD', 'Xeonacid', 'sshwy'],
    clientID: 'd6a911c8fba0194626d4',
    clientSecret: '867ec7e13cc99b420bd147cbb62d5cfec271ba81',
    distractionFreeMode: false,
    pagerDirection: 'first'
  })
  gitalk.render('gitalk-container') </script> </article> </div> </div> </main> <script>function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script> <button onclick="topFunction()" id="myBtn" class="data-tip-left" data-tip="回到顶部"> <svg class="Zi Zi--BackToTop data-tip-left" data-tip="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"> <path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path> </svg> </button> <footer class="md-footer"> <div class="md-footer-nav"> <nav class="md-footer-nav__inner md-grid"> <a href="../persistent-block-array/" title="可持久化块状数组" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class="md-flex__ellipsis"> <span class="md-footer-nav__direction"> 上一页 </span> 可持久化块状数组 </span> </div> </a> <a href="../persistent-trie/" title="可持久化字典树" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class="md-flex__ellipsis"> <span class="md-footer-nav__direction"> 下一页 </span> 可持久化字典树 </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-footer-copyright"> <div class="md-footer-copyright__highlight"> Copyright © 2016 - 2020 OI Wiki Team </div> powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/"> Material for MkDocs</a> <div id="miitbeian"></div> </div> <span style="float:right" class="build_date_utc"><a href="https://github.com/24OI/OI-wiki">最近更新：7160554, 2020-06-30</a></span> <script> /* miitbeian */
        if (window.location.hostname == "oi-wiki.com") {
          document.getElementById("miitbeian").innerHTML = `<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>`;
        }
        /* Easter Egg */
        console.log(`%c OI Wiki %c 7160554 %c`,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent");
        console.log('少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org'); </script> </div> <div class="sponsor" style="text-align:center;color:#fff;vertical-align:middle"> Supported by <span> <a href="/intro/hulu/"> <img src="https://cdn.jsdelivr.net/npm/oicdn@0.0.1/hulu-white.png" style="vertical-align:-12px;width:125px;margin-left:5px"> </a> </span></div> </div> </footer> </div> <script src="../../assets/javascripts/application.320a2241.js"></script> <script>app.initialize({version:"1.1.2",url:{base:"../.."}}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("PWA Registration failed with "+e)})</script> <script src="../../_static/js/extra.js?v=16"></script> 